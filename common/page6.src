#include "rom.h"
#include "macros.h"
#include "globals.h"

	* = 0

CODE(DEMO, DEMO)
	CMN
	SET(R0, 9.4662)
	SET(R1, 0)
	LDI(R7, R1)
	SVI(R1, R0)
	PSH(R0)
	BRS(FACTORIAL)
	POP(R4)
	SET(R5, 1)
	LDI(R6, R5)
	ESC
	BRK

BGN(FACTORIAL)
	POP(R1)
	SET(R2, 1)
	MOD(R3, R1, R2)
	SUB(R1, R1, R3)
_1	TST(R1)
	BRZ(_2)
	MUL(R2, R2, R1)
	DCR(R1)
	BRA(_1)
_2	PSH(R2)
	RTN
END(FACTORIAL)

END(DEMO)

DATA(WORKING, EXTRA)
+PI	INIT(3.1415926535)
+EXTRA	ZERO(2)
END(WORKING)
